"""
This file holds FALLBACK_LIST in which aten/primes ops will be fallbacked to AclNN op and
will not be allowed to lowering and fusion.

After fixed and verified, it can be removed from FALLBACK_LIST.
"""

import torch

from torch.ops import (
    quantized_decomposed,
    rngprims,
    _inductor_test,
    inductor,
    fsdp,
    _c10d_functional,
    _dtensor,
    # mkldnn,
    # onednn,
    # mkl,
    _quantized,
    quantized,
)

from torch._prims.rng_prims import (
    graphsafe_run_with_rng_state,
    run_and_save_rng_state,
    run_with_rng_state,
)
from torch._higher_order_ops.auto_functionalize import auto_functionalized
from torch._higher_order_ops.cond import cond
from torch._higher_order_ops.while_loop import while_loop
from torch._higher_order_ops.invoke_subgraph import invoke_subgraph
from torch._higher_order_ops._invoke_quant import invoke_quant
from torch._higher_order_ops.associative_scan import associative_scan
from torch._higher_order_ops.effects import with_effects
from torch._higher_order_ops.flex_attention import (
    flex_attention,
    flex_attention_backward,
)

aten = torch.ops.aten
prims = torch.ops.prims


# total： 1109
# exclude：
# aten.log1p: 6, aten.sin: 7, aten.cos: 7
# indirect_mem: 11, lowering_override: 6
# mkl: 12, onednn: 10
FALLBACK_LIST = [
    _c10d_functional.all_gather_into_tensor,
    _c10d_functional.all_gather_into_tensor.default,
    _c10d_functional.all_gather_into_tensor_coalesced,
    _c10d_functional.all_gather_into_tensor_coalesced.default,
    _c10d_functional.all_gather_into_tensor_out,
    _c10d_functional.all_gather_into_tensor_out.default,
    _c10d_functional.all_reduce,
    _c10d_functional.all_reduce.default,
    _c10d_functional.all_reduce_,
    _c10d_functional.all_reduce_.default,
    _c10d_functional.all_reduce_coalesced,
    _c10d_functional.all_reduce_coalesced.default,
    _c10d_functional.all_reduce_coalesced_,
    _c10d_functional.all_reduce_coalesced_.default,
    _c10d_functional.all_to_all_single,
    _c10d_functional.all_to_all_single.default,
    _c10d_functional.broadcast,
    _c10d_functional.broadcast.default,
    _c10d_functional.broadcast_,
    _c10d_functional.broadcast_.default,
    _c10d_functional.reduce_scatter_tensor,
    _c10d_functional.reduce_scatter_tensor.default,
    _c10d_functional.reduce_scatter_tensor_coalesced,
    _c10d_functional.reduce_scatter_tensor_coalesced.default,
    _c10d_functional.wait_tensor,
    _c10d_functional.wait_tensor.default,
    _dtensor.shard_dim_alltoall,
    _dtensor.shard_dim_alltoall.default,
    _inductor_test.realize,
    _inductor_test.realize.default,
    _quantized.wrapped_fbgemm_linear_fp16_weight.default,
    _quantized.wrapped_fbgemm_pack_gemm_matrix_fp16.default,
    associative_scan,  
    aten.__and__,  
    aten.__and__.bool,  
    aten.__and__.int,  
    aten.__iand__, 
    aten.__iand__.Scalar, 
    aten.__iand__.Tensor,  
    aten.__ilshift__,  
    aten.__ilshift__.Scalar,  
    aten.__ilshift__.Tensor, 
    aten.__ior__, 
    aten.__ior__.Scalar, 
    aten.__ior__.Tensor, 
    aten.__irshift__, 
    aten.__irshift__.Scalar, 
    aten.__irshift__.Tensor, 
    aten.__ixor__, 
    aten.__ixor__.Scalar, 
    aten.__ixor__.Tensor, 
    aten.__lshift__, 
    aten.__lshift__.Scalar, 
    aten.__lshift__.Scalar_out, 
    aten.__lshift__.Tensor, 
    aten.__lshift__.Tensor_out, 
    aten.__lshift__.int, 
    aten.__or__, 
    aten.__or__.bool, 
    aten.__or__.int, 
    aten.__rshift__, 
    aten.__rshift__.Scalar, 
    aten.__rshift__.Scalar_out, 
    aten.__rshift__.Tensor, 
    aten.__rshift__.Tensor_out, 
    aten.__rshift__.int, 
    aten.__xor__, 
    aten.__xor__.bool, 
    aten.__xor__.int,
    aten._adaptive_avg_pool2d, 
    aten._adaptive_avg_pool2d.default,
    aten._adaptive_avg_pool2d.out,
    aten._adaptive_avg_pool2d_backward.default, 
    aten._adaptive_avg_pool2d_backward.out,
    aten._adaptive_avg_pool3d.default,
    aten._adaptive_avg_pool3d.out,
    aten._adaptive_avg_pool3d_backward.default, 
    aten._adaptive_avg_pool3d_backward.out, 
    aten._addmm_activation.default, 
    aten._addmm_activation.out,
    aten._assert_tensor_metadata,
    aten._assert_tensor_metadata.default,
    aten._cdist_backward.default, 
    aten._cdist_backward.out, 
    aten._cdist_forward.default, 
    aten._cdist_forward.out, 
    aten._convolution, 
    aten._convolution.default, 
    aten._convolution.out, 
    aten._cudnn_rnn.default, 
    aten._cudnn_rnn.out, 
    aten._cudnn_rnn_backward.default, 
    aten._cudnn_rnn_backward.out, 
    aten._dyn_quant_matmul_4bit.default, 
    aten._dyn_quant_pack_4bit_weight.default, 
    aten._efficient_attention_backward.default, 
    aten._efficient_attention_forward.default, 
    aten._efficientzerotensor.default, 
    aten._efficientzerotensor.out, 
    aten._embedding_bag.default, 
    aten._embedding_bag.out,
    aten._embedding_bag_backward.default, 
    aten._embedding_bag_forward_only.default, 
    aten._embedding_bag_forward_only.out, 
    aten._embedding_bag_per_sample_weights_backward.default, 
    aten._embedding_bag_per_sample_weights_backward.out, 
    aten._fft_r2c.default, 
    aten._fft_r2c.out, 
    aten._flash_attention_backward.default, 
    aten._flash_attention_forward.default, 
    aten._foobar, 
    aten._foobar.default, 
    aten._foobar.out, 
    aten._fused_moving_avg_obs_fq_helper.default, 
    aten._fused_moving_avg_obs_fq_helper.out, 
    aten._fused_moving_avg_obs_fq_helper_functional.default, 
    aten._histogramdd_bin_edges.default, 
    aten._histogramdd_from_bin_cts.default, 
    aten._int_mm, 
    aten._int_mm.default, 
    aten._int_mm.out,
    aten._jagged_to_padded_dense_forward.default, 
    aten._linalg_check_errors.default, 
    aten._linalg_det.default, 
    aten._linalg_det.result, 
    aten._linalg_eigh.default, 
    aten._linalg_eigh.eigenvalues, 
    aten._linalg_slogdet.default, 
    aten._linalg_slogdet.sign, 
    aten._linalg_solve_ex.default, 
    aten._linalg_solve_ex.result, 
    aten._linalg_svd.U, 
    aten._linalg_svd.default, 
    aten._local_scalar_dense, 
    aten._local_scalar_dense.default,
    aten._neg_view,
    aten._neg_view.default,
    aten._padded_dense_to_jagged_forward,
    aten._padded_dense_to_jagged_forward.default,
    aten._pdist_backward.default,
    aten._pdist_backward.out,
    aten._pdist_forward.default,
    aten._pdist_forward.out,
    aten._scaled_dot_product_cudnn_attention.default,
    aten._scaled_dot_product_cudnn_attention_backward.default,
    aten._scaled_dot_product_efficient_attention.default,
    aten._scaled_dot_product_efficient_attention_backward.default,
    aten._scaled_dot_product_flash_attention.default,
    aten._scaled_dot_product_flash_attention_backward.default,
    aten._scaled_dot_product_flash_attention_for_cpu.default,
    aten._scaled_dot_product_flash_attention_for_cpu_backward.default,  
    aten._scaled_dot_product_fused_attention_overrideable.default,
    aten._scaled_dot_product_fused_attention_overrideable_backward.default,
    aten._scaled_mm.default,
    aten._segment_reduce_backward.default,
    aten._sparse_coo_tensor_with_dims_and_tensors.default,
    aten._sparse_coo_tensor_with_dims_and_tensors.out,
    aten._sparse_semi_structured_mm,
    aten._sparse_semi_structured_mm.default,
    aten._thnn_fused_lstm_cell.default,
    aten._thnn_fused_lstm_cell.out,
    aten._to_sparse.default,
    aten._to_sparse.out,
    aten._to_sparse.sparse_dim,
    aten._to_sparse.sparse_dim_out,
    aten._trilinear.default,
    aten._trilinear.out,
    # aten._unsafe_index,                                       # indirect_mem
    aten._unsafe_index.Tensor,
    aten._unsafe_index.Tensor_hacked_twin,
    # aten._unsafe_index_put,                                   # indirect_mem
    aten._unsafe_index_put.hacked_twin,
    aten._unsafe_masked_index,
    aten._unsafe_masked_index.default,
    aten._unsafe_masked_index_put_accumulate,
    aten._unsafe_masked_index_put_accumulate.default,
    aten._unsafe_view,
    aten._weight_int4pack_mm_for_cpu,
    aten._weight_int4pack_mm_for_cpu.default,
    aten._weight_int8pack_mm,
    aten._weight_int8pack_mm.default,
    aten.acos,
    aten.acos.Scalar,
    aten.acos.complex,
    aten.acos.default,
    aten.acos.float,
    aten.acos.int,
    aten.acos.out,
    aten.acosh,
    aten.acosh.Scalar,
    aten.acosh.complex,
    aten.acosh.default,
    aten.acosh.float,
    aten.acosh.int,
    aten.acosh.out,
    aten.adaptive_max_pool2d,
    aten.adaptive_max_pool2d_backward.default,
    aten.adaptive_max_pool2d_backward.grad_input,
    aten.adaptive_max_pool3d.default,
    aten.adaptive_max_pool3d.out,
    aten.adaptive_max_pool3d_backward.default,
    aten.adaptive_max_pool3d_backward.grad_input,
    aten.add_,
    aten.add_.Scalar,
    aten.add_.Tensor,
    aten.add_.t,
    aten.addbmm.default,
    aten.addbmm.out,
    aten.alias,
    aten.alias.default,
    # aten.amin,                                    # lowering_override
    aten.angle.Scalar,
    aten.angle.complex,
    aten.angle.float,
    aten.angle.int,
    aten.any,
    aten.any.all_out,
    aten.any.bool,
    aten.any.default,
    aten.any.dim,
    aten.any.dimname_out,
    aten.any.dims,
    aten.any.dims_out,
    aten.any.float,
    aten.any.int,
    aten.any.out,
    aten.any.str,
    aten.as_strided,
    aten.as_strided.default,
    aten.as_strided_,
    aten.as_strided_.default,
    aten.as_strided_copy,
    aten.as_strided_copy.default,
    aten.as_strided_copy.out,
    aten.as_strided_scatter,
    aten.as_strided_scatter.default,
    aten.as_strided_scatter.out,
    aten.asin,
    aten.asin.Scalar,
    aten.asin.complex,
    aten.asin.default,
    aten.asin.float,
    aten.asin.int,
    aten.asin.out,
    aten.asinh,
    aten.asinh.Scalar,
    aten.asinh.complex,
    aten.asinh.default,
    aten.asinh.float,
    aten.asinh.int,
    aten.asinh.out,
    aten.atan,
    aten.atan.Scalar,
    aten.atan.complex,
    aten.atan.default,
    aten.atan.float,
    aten.atan.int,
    aten.atan.out,
    aten.atan2,
    aten.atan2.Scalar_Scalar,
    aten.atan2.default,
    aten.atan2.float,
    aten.atan2.float_int,
    aten.atan2.int,
    aten.atan2.int_float,
    aten.atan2.out,
    aten.atanh,
    aten.atanh.Scalar,
    aten.atanh.complex,
    aten.atanh.default,
    aten.atanh.float,
    aten.atanh.int,
    aten.atanh.out,
    aten.avg_pool2d,
    aten.avg_pool2d.default,
    aten.avg_pool2d.out,
    aten.avg_pool2d_backward,
    aten.avg_pool2d_backward.default,
    aten.avg_pool2d_backward.grad_input,
    aten.avg_pool3d,
    aten.avg_pool3d.default,
    aten.avg_pool3d.out,
    aten.avg_pool3d_backward,
    aten.avg_pool3d_backward.default,
    aten.avg_pool3d_backward.grad_input,
    aten.baddbmm,
    aten.baddbmm.default,
    aten.baddbmm.out,
    aten.bernoulli.p,
    aten.bernoulli_,
    aten.bernoulli_.Tensor,
    aten.bernoulli_.float,
    aten.bitwise_and_,
    aten.bitwise_left_shift,
    aten.bitwise_left_shift.Scalar_Tensor,
    aten.bitwise_left_shift.Scalar_Tensor_out,
    aten.bitwise_left_shift.Tensor,
    aten.bitwise_left_shift.Tensor_Scalar,
    aten.bitwise_left_shift.Tensor_Scalar_out,
    aten.bitwise_left_shift.Tensor_out,
    aten.bitwise_left_shift_,
    aten.bitwise_left_shift_.Tensor,
    aten.bitwise_left_shift_.Tensor_Scalar,
    aten.bitwise_not,
    aten.bitwise_not.default,
    aten.bitwise_not.out,
    aten.bitwise_not_,
    aten.bitwise_not_.default,
    aten.bitwise_or,
    aten.bitwise_or.Scalar,
    aten.bitwise_or.Scalar_Tensor,
    aten.bitwise_or.Scalar_Tensor_out,
    aten.bitwise_or.Scalar_out,
    aten.bitwise_or.Tensor,
    aten.bitwise_or.Tensor_out,
    aten.bitwise_or_,
    aten.bitwise_right_shift,
    aten.bitwise_right_shift.Scalar_Tensor,
    aten.bitwise_right_shift.Scalar_Tensor_out,
    aten.bitwise_right_shift.Tensor,
    aten.bitwise_right_shift.Tensor_Scalar,
    aten.bitwise_right_shift.Tensor_Scalar_out,
    aten.bitwise_right_shift.Tensor_out,
    aten.bitwise_right_shift_,
    aten.bitwise_right_shift_.Tensor,
    aten.bitwise_right_shift_.Tensor_Scalar,
    aten.bitwise_xor_,
    aten.bitwise_xor_.Scalar,
    aten.bitwise_xor_.Tensor,
    aten.broadcast_tensors,
    aten.bucketize,
    aten.bucketize.Scalar,
    aten.bucketize.Scalar_out,
    aten.bucketize.Tensor,
    aten.bucketize.Tensor_out,
    # aten.cat,                                     # lowering_override
    aten.cat.names_out,
    aten.cat.out,
    aten.cholesky_inverse.default,
    aten.cholesky_inverse.out,
    aten.cholesky_solve.default,
    aten.cholesky_solve.out,
    aten.constant_pad_nd,
    aten.constant_pad_nd.default,
    aten.constant_pad_nd.out,
    aten.convolution,
    aten.convolution.default,
    aten.convolution.out,
    aten.copysign,
    aten.copysign.Scalar,
    aten.copysign.Scalar_out,
    aten.copysign.Tensor,
    aten.copysign.default,
    aten.copysign.float,
    aten.copysign.float_int,
    aten.copysign.int,
    aten.copysign.int_float,
    aten.copysign.out,
    # aten.cos,
    # aten.cos.Scalar,
    # aten.cos.complex,
    # aten.cos.default,
    # aten.cos.float,
    # aten.cos.int,
    # aten.cos.out,
    aten.cosh,
    aten.cosh.Scalar,
    aten.cosh.complex,
    aten.cosh.default,
    aten.cosh.float,
    aten.cosh.int,
    aten.cosh.out,
    aten.cummax,
    aten.cummax.default,
    aten.cummax.dimname_out,
    aten.cummax.out,
    aten.cummin,
    aten.cummin.default,
    aten.cummin.dimname_out,
    aten.cummin.out,
    aten.cumprod,
    aten.cumprod.default,
    aten.cumprod.dimname_out,
    aten.cumprod.out,
    # aten.cumsum,                                      # lowering_override
    # aten.cumsum.default,                              # lowering_override
    aten.cumsum.dimname_out,
    aten.cumsum.out,
    aten.detach,
    aten.detach_,
    aten.diagonal,
    aten.diagonal.Dimname,
    aten.diagonal.default,
    aten.diagonal_copy,
    aten.diagonal_scatter,
    aten.diagonal_scatter.default,
    aten.diagonal_scatter.out,
    aten.digamma.default,
    aten.digamma.out,
    aten.div_.Tensor,
    aten.div_.Tensor_mode,
    # aten.embedding,                                   # indirect_mem
    aten.embedding.default,
    aten.embedding.out,
    aten.empty,
    aten.empty.memory_format,
    aten.empty.names,
    aten.empty.names_out,
    aten.empty.out,
    aten.empty_like,
    aten.empty_strided,
    aten.empty_strided.default,
    aten.empty_strided.out,
    aten.erfc,
    aten.erfc.Scalar,
    aten.erfc.default,
    aten.erfc.float,
    aten.erfc.int,
    aten.erfc.out,
    aten.erfinv,
    aten.erfinv.default,
    aten.erfinv.out,
    aten.exp2,
    aten.exp2.default,
    aten.exp2.out,
    aten.expand_as,
    aten.expand_as.default,
    aten.expm1,
    aten.expm1.Scalar,
    aten.expm1.default,
    aten.expm1.float,
    aten.expm1.int,
    aten.expm1.out,
    aten.exponential.default,
    aten.fill_,
    aten.fmod,
    aten.fmod.Scalar,
    aten.fmod.Scalar_out,
    aten.fmod.Tensor,
    aten.fmod.Tensor_out,
    aten.fmod.default,
    aten.fmod.float,
    aten.fmod.float_int,
    aten.fmod.int,
    aten.fmod.int_float,
    aten.fractional_max_pool2d,
    aten.fractional_max_pool2d.default,
    aten.fractional_max_pool2d.output,
    aten.fractional_max_pool2d_backward.default,
    aten.fractional_max_pool2d_backward.grad_input,
    aten.fractional_max_pool3d.default,
    aten.fractional_max_pool3d.output,
    aten.fractional_max_pool3d_backward.default,
    aten.fractional_max_pool3d_backward.grad_input,
    aten.frexp,
    aten.frexp.Tensor,
    aten.frexp.Tensor_out,
    aten.frexp.default,
    aten.full_like,
    # aten.gather,                                  # indirect_mem
    aten.gather.default,
    aten.gather.dimname_out,
    aten.gather.out,
    aten.gcd.default,
    aten.geqrf.a,
    aten.geqrf.default,
    aten.glu,
    aten.glu.default,
    aten.glu.out,
    aten.grid_sampler_2d_backward.default,
    aten.grid_sampler_2d_backward.out,
    aten.histc.default,
    aten.histc.out,
    aten.histogram.bin_ct,
    aten.hypot,
    aten.hypot.default,
    aten.hypot.out,
    aten.i0.default,
    aten.i0.out,
    aten.igamma.default,
    aten.igamma.out,
    aten.igammac.default,
    aten.igammac.out,
    # aten.index,                                   # indirect_mem         
    aten.index.Tensor,
    aten.index.Tensor_hacked_twin,
    aten.index.Tensor_out,
    aten.index.list_Tensor,
    aten.index.list_bool,
    aten.index.list_float,
    aten.index.list_int,
    aten.index.list_str,
    aten.index.str,
    # aten.index_put,                               # indirect_mem 
    aten.index_put.default,
    aten.index_put.hacked_twin,
    aten.index_put.out,
    # aten.index_put_,                              # indirect_mem 
    aten.index_put_.default,
    aten.index_put_.hacked_twin,
    aten.isinf,
    aten.isinf.complex,
    aten.isinf.default,
    aten.isinf.float,
    aten.isinf.out,
    aten.kthvalue.default,
    aten.kthvalue.dimname_out,
    aten.kthvalue.values,
    aten.lgamma,
    aten.lgamma.Scalar,
    aten.lgamma.default,
    aten.lgamma.float,
    aten.lgamma.int,
    aten.lgamma.out,
    aten.lift,
    aten.lift_fresh,
    aten.lift_fresh.default,
    aten.lift_fresh_copy,
    aten.lift_fresh_copy.default,
    aten.lift_fresh_copy.out,
    aten.linalg_cholesky_ex.L,
    aten.linalg_cholesky_ex.default,
    aten.linalg_householder_product.default,
    aten.linalg_householder_product.out,
    aten.linalg_inv_ex.default,
    aten.linalg_inv_ex.inverse,
    aten.linalg_ldl_factor_ex.default,
    aten.linalg_ldl_factor_ex.out,
    aten.linalg_ldl_solve.default,
    aten.linalg_ldl_solve.out,
    aten.linalg_lu.default,
    aten.linalg_lu.out,
    aten.linalg_lu_factor_ex.default,
    aten.linalg_lu_factor_ex.out,
    aten.linalg_lu_solve.default,
    aten.linalg_lu_solve.out,
    aten.linalg_matrix_exp.default,
    aten.linalg_matrix_exp.out,
    aten.linalg_pinv.atol_rtol_tensor,
    aten.linalg_qr.default,
    aten.linalg_qr.out,
    aten.linalg_solve_triangular.default,
    aten.linalg_solve_triangular.out,
    aten.log10,
    aten.log10.Scalar,
    aten.log10.complex,
    aten.log10.default,
    aten.log10.float,
    aten.log10.int, 
    aten.log10.out,
    # aten.log1p,
    # aten.log1p.Scalar,
    # aten.log1p.default,
    # aten.log1p.float,
    # aten.log1p.int,
    # aten.log1p.out,
    aten.log2,
    aten.log2.default,
    aten.log2.out,
    aten.logcumsumexp,
    aten.logcumsumexp.default,
    aten.logcumsumexp.dimname_out,
    aten.logcumsumexp.out,
    aten.logical_and_,
    aten.logical_and_.default,
    aten.logical_not_,
    aten.logical_not_.default,
    aten.logical_or_,
    aten.logical_or_.default,
    aten.logical_xor,
    aten.logical_xor.default,
    aten.logical_xor.out,
    aten.logical_xor_,
    aten.logical_xor_.default,
    aten.lu_unpack.default,
    aten.lu_unpack.out,
    aten.masked_scatter_backward.default,
    aten.max_pool2d_with_indices,
    aten.max_pool2d_with_indices_backward,
    aten.max_pool2d_with_indices_backward.default,
    aten.max_pool2d_with_indices_backward.grad_input,
    aten.max_pool3d_with_indices.default,
    aten.max_pool3d_with_indices.out,
    aten.max_pool3d_with_indices_backward.default,
    aten.max_pool3d_with_indices_backward.grad_input,
    aten.median.default,
    aten.median.dim,
    aten.median.dim_values,
    aten.median.names_dim_values,
    aten.median.out,
    # aten.mkldnn_rnn_layer.default,
    aten.mode.default,
    aten.mode.dimname_out,
    aten.mode.values,
    aten.mul_,
    aten.mul_.Scalar,
    aten.mul_.Tensor,
    aten.mul_.t,
    aten.nanmedian.default,
    aten.nanmedian.dim,
    aten.nanmedian.dim_values,
    aten.nanmedian.names_dim_values,
    aten.nanmedian.out,
    aten.native_dropout,
    aten.native_dropout.default,
    aten.native_dropout.out,
    aten.new_empty,
    aten.new_empty_strided,
    aten.new_empty_strided.default,
    aten.new_empty_strided.out,
    aten.nextafter,
    aten.nextafter.default,
    aten.nextafter.out,
    aten.nonzero.default,
    aten.ormqr.default,
    aten.ormqr.out,
    aten.polygamma.default,
    aten.polygamma.out,
    aten.prod,
    aten.prod.Dimname_out,
    aten.prod.default,
    aten.prod.dim_int,
    aten.prod.int_out,
    aten.prod.out,
    aten.rand,
    aten.rand.default,
    aten.rand.generator,
    aten.rand.generator_out,
    aten.rand.generator_with_names,
    aten.rand.generator_with_names_out,
    aten.rand.names,
    aten.rand.names_out,
    aten.rand.out,
    aten.randint.generator,
    aten.randint.generator_out,
    aten.randint.low,
    aten.randint.low_generator,
    aten.randint.low_generator_out,
    aten.randint.low_out,
    aten.randint.out,
    aten.randn,
    aten.randn.default,
    aten.randn.generator,
    aten.randn.generator_out,
    aten.randn.generator_with_names,
    aten.randn.generator_with_names_out,
    aten.randn.names,
    aten.randn.names_out,
    aten.randn.out,
    aten.randperm.default,
    aten.randperm.generator,
    aten.randperm.generator_out, 
    aten.randperm.out,
    aten.relu_,
    aten.relu_.default,
    aten.remainder,
    aten.remainder.Scalar,
    aten.remainder.Scalar_Tensor,
    aten.remainder.Scalar_Tensor_out,
    aten.remainder.Scalar_out,
    aten.remainder.Tensor,
    aten.remainder.Tensor_out,
    aten.remainder.default,
    aten.remainder.float,
    aten.remainder.float_int,
    aten.remainder.int,
    aten.remainder.int_float,
    aten.replication_pad1d_backward.default,
    aten.replication_pad1d_backward.grad_input,
    aten.replication_pad2d_backward.default,
    aten.replication_pad2d_backward.grad_input,
    aten.resize,
    aten.resize.default,
    aten.resize.out,
    aten.resize_.default,
    aten.resize_as_.default,
    aten.round.default,
    # aten.scatter,                                 # indirect_mem 
    aten.scatter.reduce,
    aten.scatter.reduce_out,
    aten.scatter.src,
    aten.scatter.src_out,
    aten.scatter.value,
    aten.scatter.value_out,
    aten.scatter.value_reduce,
    aten.scatter.value_reduce_out,
    # aten.scatter_,                                # indirect_mem 
    aten.scatter_.reduce,
    aten.scatter_.src,
    aten.scatter_.value,
    aten.scatter_.value_reduce,
    aten.scatter_add,
    aten.scatter_add.default,
    aten.scatter_add.out,
    aten.scatter_add_,
    aten.scatter_add_.default,
    # aten.scatter_reduce,                          # indirect_mem
    aten.scatter_reduce.two,
    aten.scatter_reduce.two_out,
    # aten.scatter_reduce_,                         # indirect_mem
    aten.scatter_reduce_.two, 
    aten.searchsorted.Tensor,
    aten.segment_reduce.default,
    aten.set_.source_Tensor,
    aten.sigmoid_,
    aten.sigmoid_.default,
    aten.signbit,
    aten.signbit.default,
    aten.signbit.out,
    # aten.sin,
    # aten.sin.Scalar,
    # aten.sin.complex,
    # aten.sin.default,
    # aten.sin.float,
    # aten.sin.int,
    # aten.sin.out,
    aten.sinh,
    aten.sinh.Scalar,
    aten.sinh.complex,
    aten.sinh.default,
    aten.sinh.float,
    aten.sinh.int,
    aten.sinh.out,
    aten.sort.Tensor,
    aten.sort.any,
    aten.sort.bool,
    aten.sort.default,
    aten.sort.dimname_values,
    aten.sort.dimname_values_stable,
    aten.sort.float,
    aten.sort.int,
    aten.sort.stable,
    aten.sort.str,
    aten.sort.values,
    aten.sort.values_stable,
    aten.special_airy_ai.default,
    aten.special_airy_ai.out,
    aten.special_bessel_j0.default,
    aten.special_bessel_j0.out,
    aten.special_bessel_j1.default,
    aten.special_bessel_j1.out,
    aten.special_bessel_y0.default,
    aten.special_bessel_y0.out,
    aten.special_bessel_y1.default,
    aten.special_bessel_y1.out,
    aten.special_chebyshev_polynomial_t.default,
    aten.special_chebyshev_polynomial_t.n_scalar,
    aten.special_chebyshev_polynomial_t.n_scalar_out,
    aten.special_chebyshev_polynomial_t.out, 
    aten.special_chebyshev_polynomial_t.x_scalar, 
    aten.special_chebyshev_polynomial_t.x_scalar_out,    
    aten.special_chebyshev_polynomial_u.default,
    aten.special_chebyshev_polynomial_u.n_scalar,
    aten.special_chebyshev_polynomial_u.n_scalar_out,
    aten.special_chebyshev_polynomial_u.out,
    aten.special_chebyshev_polynomial_u.x_scalar,
    aten.special_chebyshev_polynomial_u.x_scalar_out,
    aten.special_chebyshev_polynomial_v.default,
    aten.special_chebyshev_polynomial_v.n_scalar,
    aten.special_chebyshev_polynomial_v.n_scalar_out,
    aten.special_chebyshev_polynomial_v.out,
    aten.special_chebyshev_polynomial_v.x_scalar,
    aten.special_chebyshev_polynomial_v.x_scalar_out,
    aten.special_chebyshev_polynomial_w.default,
    aten.special_chebyshev_polynomial_w.n_scalar,
    aten.special_chebyshev_polynomial_w.n_scalar_out,
    aten.special_chebyshev_polynomial_w.out,
    aten.special_chebyshev_polynomial_w.x_scalar,
    aten.special_chebyshev_polynomial_w.x_scalar_out,
    aten.special_erf,
    aten.special_erf.out,
    aten.special_erfcx.default,
    aten.special_erfcx.out,
    aten.special_gammainc.out,
    aten.special_gammaincc.out,
    aten.special_hermite_polynomial_h.default,
    aten.special_hermite_polynomial_h.n_scalar,
    aten.special_hermite_polynomial_h.n_scalar_out,
    aten.special_hermite_polynomial_h.out,
    aten.special_hermite_polynomial_h.x_scalar,
    aten.special_hermite_polynomial_h.x_scalar_out,
    aten.special_hermite_polynomial_he.default,
    aten.special_hermite_polynomial_he.n_scalar,
    aten.special_hermite_polynomial_he.n_scalar_out,
    aten.special_hermite_polynomial_he.out,
    aten.special_hermite_polynomial_he.x_scalar,
    aten.special_hermite_polynomial_he.x_scalar_out,
    aten.special_i0e.default,
    aten.special_i0e.out,
    aten.special_i1.default,
    aten.special_i1.out,
    aten.special_i1e.default,
    aten.special_i1e.out, 
    aten.special_laguerre_polynomial_l.default, 
    aten.special_laguerre_polynomial_l.n_scalar,
    aten.special_laguerre_polynomial_l.n_scalar_out,
    aten.special_laguerre_polynomial_l.out,
    aten.special_laguerre_polynomial_l.x_scalar,
    aten.special_laguerre_polynomial_l.x_scalar_out,
    aten.special_legendre_polynomial_p.default,
    aten.special_legendre_polynomial_p.n_scalar, 
    aten.special_legendre_polynomial_p.n_scalar_out,
    aten.special_legendre_polynomial_p.out,
    aten.special_legendre_polynomial_p.x_scalar,
    aten.special_legendre_polynomial_p.x_scalar_out,
    aten.special_modified_bessel_i0.default,
    aten.special_modified_bessel_i0.out,
    aten.special_modified_bessel_i1.default,
    aten.special_modified_bessel_i1.out,
    aten.special_modified_bessel_k0.default,
    aten.special_modified_bessel_k0.out,
    aten.special_modified_bessel_k1.default,
    aten.special_modified_bessel_k1.out,
    aten.special_ndtr.out,
    aten.special_ndtri.default,
    aten.special_ndtri.out,
    aten.special_scaled_modified_bessel_k0.default,
    aten.special_scaled_modified_bessel_k0.out,
    aten.special_scaled_modified_bessel_k1.default,
    aten.special_scaled_modified_bessel_k1.out,
    aten.special_shifted_chebyshev_polynomial_t.default,
    aten.special_shifted_chebyshev_polynomial_t.n_scalar,
    aten.special_shifted_chebyshev_polynomial_t.n_scalar_out,
    aten.special_shifted_chebyshev_polynomial_t.out,
    aten.special_shifted_chebyshev_polynomial_t.x_scalar,
    aten.special_shifted_chebyshev_polynomial_t.x_scalar_out,
    aten.special_shifted_chebyshev_polynomial_u.default,
    aten.special_shifted_chebyshev_polynomial_u.n_scalar,
    aten.special_shifted_chebyshev_polynomial_u.n_scalar_out,
    aten.special_shifted_chebyshev_polynomial_u.out,
    aten.special_shifted_chebyshev_polynomial_u.x_scalar,
    aten.special_shifted_chebyshev_polynomial_u.x_scalar_out,
    aten.special_shifted_chebyshev_polynomial_v.default,
    aten.special_shifted_chebyshev_polynomial_v.n_scalar,
    aten.special_shifted_chebyshev_polynomial_v.n_scalar_out,
    aten.special_shifted_chebyshev_polynomial_v.out,
    aten.special_shifted_chebyshev_polynomial_v.x_scalar,
    aten.special_shifted_chebyshev_polynomial_v.x_scalar_out,
    aten.special_shifted_chebyshev_polynomial_w.default,
    aten.special_shifted_chebyshev_polynomial_w.n_scalar,
    aten.special_shifted_chebyshev_polynomial_w.n_scalar_out,
    aten.special_shifted_chebyshev_polynomial_w.out,
    aten.special_shifted_chebyshev_polynomial_w.x_scalar,
    aten.special_shifted_chebyshev_polynomial_w.x_scalar_out,
    aten.special_spherical_bessel_j0.default,
    aten.special_spherical_bessel_j0.out,
    aten.special_zeta.default,
    aten.special_zeta.other_scalar,
    aten.special_zeta.other_scalar_out,
    aten.special_zeta.out,
    aten.special_zeta.self_scalar,
    aten.special_zeta.self_scalar_out,
    aten.split,
    aten.split.Tensor,
    aten.split.default,
    aten.split.sizes,
    aten.split.str,
    aten.split_with_sizes,
    aten.split_with_sizes.default,
    aten.square,
    aten.square.out,
    aten.squeeze_,
    aten.squeeze_.default,
    aten.squeeze_.dim,
    aten.squeeze_.dimname,
    aten.squeeze_.dims,
    aten.squeeze_copy,
    aten.sub_,
    aten.sub_.Scalar,
    aten.sub_.Tensor,
    aten.sym_constrain_range,
    aten.sym_constrain_range.default,
    aten.sym_numel,
    aten.sym_numel.default,
    aten.tan,
    aten.tan.Scalar,
    aten.tan.complex,
    aten.tan.default,
    aten.tan.float,
    aten.tan.int,
    aten.tan.out,
    aten.topk.default,
    aten.topk.values,
    aten.triangular_solve.X,
    aten.triangular_solve.default,
    aten.true_divide,
    aten.true_divide.out,
    aten.trunc,
    aten.trunc.default,
    aten.trunc.out,
    aten.unbind,
    aten.unbind.Dimname,
    aten.unbind.int,
    aten.unfold,
    aten.unfold.default,
    aten.uniform.default,
    aten.uniform.out,
    aten.unsqueeze_,
    aten.unsqueeze_.default,
    aten.upsample_bicubic2d_backward.default,
    aten.upsample_bicubic2d_backward.grad_input, 
    aten.upsample_linear1d_backward.default, 
    aten.upsample_linear1d_backward.grad_input,
    aten.upsample_nearest2d_backward.default,
    aten.upsample_trilinear3d_backward.default,
    aten.upsample_trilinear3d_backward.grad_input,
    # aten.var,                                     # lowering_override
    aten.var.correction,
    aten.var.correction_names_out,
    aten.var.correction_out,
    aten.var.names_out,
    aten.var.out,
    # aten.var_mean,                                # lowering_override
    aten.var_mean.correction,
    aten.var_mean.correction_out,
    aten.view,
    aten.view.default,
    aten.view.dtype,
    aten.view_as_complex.default,
    aten.zeros.names,
    auto_functionalized,
    cond,
    flex_attention,
    flex_attention_backward,
    fsdp.copy_.default,
    graphsafe_run_with_rng_state,
    inductor.resize_storage_bytes_,
    inductor.resize_storage_bytes_.default,
    invoke_quant,
    invoke_subgraph,
    # mkl._mkl_linear,
    # mkl._mkl_linear.default,
    # mkldnn._convolution_pointwise,
    # mkldnn._convolution_pointwise.binary,
    # mkldnn._convolution_pointwise.default,
    # mkldnn._convolution_pointwise_.binary,
    # mkldnn._convolution_transpose_pointwise,
    # mkldnn._convolution_transpose_pointwise.default,
    # mkldnn._linear_pointwise,
    # mkldnn._linear_pointwise.binary,
    # mkldnn._linear_pointwise.default,
    # onednn.qconv2d_pointwise,
    # onednn.qconv2d_pointwise.binary,
    # onednn.qconv2d_pointwise.binary_tensor,
    # onednn.qconv2d_pointwise.default,
    # onednn.qconv2d_pointwise.tensor,
    # onednn.qlinear_pointwise,
    # onednn.qlinear_pointwise.binary,
    # onednn.qlinear_pointwise.binary_tensor,
    # onednn.qlinear_pointwise.default,
    # onednn.qlinear_pointwise.tensor,    
    prims._low_memory_max_pool2d_offsets_to_indices,
    prims._low_memory_max_pool2d_offsets_to_indices.default,
    prims._low_memory_max_pool2d_with_offsets,
    prims._low_memory_max_pool2d_with_offsets.default,
    prims._sink_tokens.default,
    prims._unsafe_index_put_.default,
    prims.abs,
    prims.abs.default,
    prims.acos,
    prims.acos.default,
    prims.acosh,
    prims.acosh.default,
    prims.add,
    prims.add.default,
    prims.asin,
    prims.asin.default,
    prims.asinh,
    prims.asinh.default,
    prims.atan,
    prims.atan.default,
    prims.atan2,
    prims.atan2.default,
    prims.atanh,
    prims.atanh.default,
    prims.bessel_j0,
    prims.bessel_j0.default,
    prims.bessel_j1,
    prims.bessel_j1.default,
    prims.bitwise_and,
    prims.bitwise_and.default,
    prims.bitwise_not,
    prims.bitwise_not.default,
    prims.bitwise_or,
    prims.bitwise_or.default,
    prims.bitwise_xor,
    prims.bitwise_xor.default,
    prims.ceil,
    prims.ceil.default,
    prims.copy_strided.default,
    prims.cos,
    prims.cos.default,
    prims.cosh,
    prims.cosh.default,
    prims.digamma,
    prims.digamma.default,
    prims.div,
    prims.div.default,
    prims.eq,
    prims.eq.default,
    prims.erf,    
    prims.erf.default,
    prims.erfc,
    prims.erfc.default,
    prims.erfcx,
    prims.erfcx.default,
    prims.exp,
    prims.exp.default,
    prims.exp2,
    prims.exp2.default,
    prims.expm1,
    prims.expm1.default,
    prims.fma,
    prims.fma.default,
    prims.fmod,
    prims.fmod.default,
    prims.frexp,
    prims.frexp.default,
    prims.ge,
    prims.ge.default,
    prims.gt,
    prims.gt.default,
    prims.hypot,
    prims.hypot.default,
    prims.igamma,
    prims.igamma.default,
    prims.igammac,
    prims.igammac.default,
    prims.inductor_force_stride_order.default,
    prims.inductor_lookup_seed.default,
    prims.inductor_randint.default,
    prims.inductor_random.default,
    prims.inductor_seed.default,
    prims.inductor_seeds.default,
    prims.le,
    prims.le.default,
    prims.lgamma, 
    prims.lgamma.default,
    prims.log,
    prims.log.default,
    prims.log10,
    prims.log10.default,
    prims.log1p,
    prims.log1p.default,
    prims.log2,
    prims.log2.default,
    prims.lt,
    prims.lt.default,
    prims.minimum,
    prims.minimum.default,
    prims.ndtri,
    prims.ndtri.default, 
    prims.ne, 
    prims.ne.default,
    prims.neg,
    prims.neg.default,
    prims.nextafter,
    prims.nextafter.default,
    prims.prepare_softmax_online.default,
    prims.reciprocal,
    prims.reciprocal.default,
    prims.remainder,
    prims.remainder.default,
    prims.rev.default,
    prims.rsqrt,
    prims.rsqrt.default,
    prims.sign,
    prims.sign.default,
    prims.signbit,
    prims.signbit.default,
    prims.sin,
    prims.sin.default,
    prims.sinh,
    prims.sinh.default,
    prims.spherical_bessel_j0,
    prims.spherical_bessel_j0.default,
    prims.sqrt,
    prims.sqrt.default,
    prims.sub,
    prims.sub.default,
    prims.sum,
    prims.sum.default,
    prims.tan,
    prims.tan.default,
    prims.tanh,
    prims.tanh.default,
    prims.var,
    prims.var.default,
    prims.view_of,
    prims.view_of.default,
    prims.xor_sum,
    prims.xor_sum.default,
    prims.zeta,
    prims.zeta.default,
    quantized.max_pool2d.default,
    quantized_decomposed.dequantize_per_channel,
    quantized_decomposed.dequantize_per_channel.default,
    quantized_decomposed.dequantize_per_tensor.default,
    quantized_decomposed.dequantize_per_tensor.tensor,
    quantized_decomposed.quantize_per_channel,
    quantized_decomposed.quantize_per_channel.default,
    quantized_decomposed.quantize_per_tensor.default,
    quantized_decomposed.quantize_per_tensor.tensor,
    rngprims.philox_rand,
    rngprims.philox_rand.default,
    run_and_save_rng_state,
    run_with_rng_state,
    while_loop,
    with_effects,
]